<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesi√≥n - Slushyapp</title>
    <link rel="icon" href="/images/Slushylogo.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/login-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
<header class="header">
    <div class="container">
        <div class="header-content">
            <div class="logo">
                <img src="/images/Slushylogo.png" alt="Slushy App" class="logo-img">
            </div>

            <nav class="main-nav">
                <ul class="nav-list">
                    <li><a href="/" class="nav-link">Inicio</a></li>
                    <li><a href="/servicios" class="nav-link">Servicios</a></li>
                    <li><a href="/mebresia" class="nav-link">Membres√≠a VIP</a></li>
                    <li><a href="/contacto" class="nav-link">Contacto</a></li>
                </ul>
            </nav>

            <div class="header-actions">
                <a href="/login" class="btn btn-primary">Ingresa</a>
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </div>
</header>
<div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-content">
        <button class="close-menu" id="closeMenu">
            <i class="fas fa-times"></i>
        </button>
        <div class="mobile-menu-container">
            <ul class="mobile-nav-list">
                <li><a href="/" class="nav-link">Inicio</a></li>
                <li><a href="/servicios" class="nav-link">Servicios</a></li>
                <li><a href="/mebresia" class="nav-link">Membres√≠a VIP</a></li>
                <li><a href="/contacto" class="nav-link">Contacto</a></li>
            </ul>
        </div>
    </div>
</div>

<main class="auth-main">
    <!-- Elementos del fondo -->
    <div class="auth-background">
        <div class="auth-water-effect"></div>
        <div class="auth-car-silhouettes"></div>
        <div class="auth-light-reflections"></div>
    </div>

    <!-- Contenido del formulario -->
    <section class="auth-section">
        <div class="container">
            <div class="auth-container">
                <div class="auth-header">
                    <h1 class="section-title">Accede a tu cuenta</h1>
                    <p class="section-description">Ingresa tus credenciales para Loguearte en tu cuenta de Slushy</p>
                </div>

                <form class="auth-form" id="loginForm">
                    <div class="form-group">
                        <label for="email" class="form-label">Correo Electr√≥nico</label>
                        <input type="email" id="email" class="form-input" placeholder="tucorreo@example.com" required>
                    </div>

                    <div class="form-group">
                        <label for="password" class="form-label">Contrase√±a</label>
                        <input type="password" id="password" class="form-input" placeholder="Ingresa Tu Contrase√±a" required>
                    </div>

                    <div class="form-group remember-forgot">
                        <div class="checkbox-group">
                            <input type="checkbox" id="remember" class="form-checkbox">
                            <label for="remember">Recordar sesi√≥n</label>
                        </div>
         <!---               <a href="#" class="forgot-password">¬øOlvidaste tu contrase√±a?</a> -->
                    </div>

                    <button type="submit" class="btn btn-primary btn-block btn-lg">Iniciar Sesi√≥n</button>
                    <div class="auth-footer">
                        ¬øNo tienes una cuenta? <a href="/registerSlushy" class="auth-link">Reg√≠strate aqu√≠</a>
                    </div>
                </form>
            </div>
        </div>
    </section>
</main>
<footer class="footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-about">
                <div class="logo">
                    <img src="/images/Slushylogo.png" alt="Slushy App" class="logo-img">
                </div>
                <p class="footer-description">
                    La mejor aplicaci√≥n para el cuidado de tu veh√≠culo. Reserva citas, monitorea el progreso y disfruta de beneficios exclusivos.
                </p>
            </div>

            <div class="footer-links">
                <h3 class="footer-title">Enlaces R√°pidos</h3>
                <ul class="footer-nav">
                    <li><a href="/" class="nav-link">Inicio</a></li>
                    <li><a href="/servicios" class="nav-link">Servicios</a></li>
                    <li><a href="/mebresia" class="nav-link">Membres√≠a VIP</a></li>
                    <li><a href="/contacto" class="nav-link">Contacto</a></li>
                </ul>
            </div>

            <div class="footer-newsletter">
                <h3 class="footer-title">Suscr√≠bete</h3>
                <p class="footer-description">
                    Recibe nuestras √∫ltimas noticias y promociones exclusivas
                </p>
                <div class="newsletter-form">
                    <input type="email" placeholder="Tu correo electr√≥nico" class="newsletter-input">
                    <button type="submit" class="btn btn-primary">Enviar</button>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">¬© <span id="currentYear">2023</span> Slushy App. Todos los derechos reservados.</p>
        </div>
    </div>
</footer>
<script>
    // Mobile Menu Toggle
  const menuToggle = document.getElementById('menuToggle');
  const mobileMenu = document.getElementById('mobileMenu');
  const closeMenu = document.getElementById('closeMenu');

  // Abrir el men√∫ al hacer clic en el bot√≥n de hamburguesa (‚ò∞)
  menuToggle.addEventListener('click', function() {
      mobileMenu.classList.add('active');
  });

  // Cerrar el men√∫ al hacer clic en el bot√≥n de "X"
  closeMenu.addEventListener('click', function() {
      mobileMenu.classList.remove('active');
  });

  // Cerrar el men√∫ al hacer clic en cualquier enlace del men√∫ m√≥vil
  const mobileLinks = document.querySelectorAll('.mobile-nav-list .nav-link');
  mobileLinks.forEach(link => {
      link.addEventListener('click', function() {
          mobileMenu.classList.remove('active');
      });
  });

  // Cerrar el men√∫ autom√°ticamente al redimensionar la pantalla a desktop (‚â•1024px)
  function handleResize() {
      if (window.innerWidth >= 1024 && mobileMenu.classList.contains('active')) {
          mobileMenu.classList.remove('active');
      }
  }

  window.addEventListener('resize', handleResize);

      // Actualizar el a√±o en el footer
      document.getElementById('currentYear').textContent = new Date().getFullYear();
</script>
<script>
    document.getElementById("loginForm").addEventListener("submit", async function(event) {
      event.preventDefault();

      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      try {
        const response = await fetch("/auth/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
          credentials: "include" // üî• Esto es CLAVE para que reciba la cookie
        });

        if (!response.ok) {
          const error = await response.text();
          alert("Error: " + error);
          return;
        }

        const data = await response.json();

        switch (data.rol) {
          case "ADMIN":
            window.location.href = "/admin/dashboard";
            break;
          case "EMPLOYEE":
            window.location.href = "/employee/dashboard";
            break;
          case "USER":
            window.location.href = "/user/dashboard";
            break;
          default:
            alert("Rol desconocido");
        }

      } catch (error) {
        console.error("Error en login:", error);
        alert("Ocurri√≥ un error al iniciar sesi√≥n");
      }
    });
</script>
</body>
</html>